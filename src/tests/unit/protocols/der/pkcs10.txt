proto der
proto-dictionary pkcs10
fuzzer-out der

proto-dictionary-root Foo

# Test the fuzzer with a dictionary of DER-encoded PKCS#10 requests

decode-pair 30 03 02 01 80
match Foo = { Test-Integer = -128 }

decode-pair 30 03 02 01 7F
match Foo = { Test-Integer = 127 }

decode-pair 30 04 02 02 00 80
match Foo = { Test-Integer = 128 }

decode-pair 30 04 02 02 FF 80
match Integer is not correctly DER encoded

decode-pair 30 04 02 02 00 70
match Integer is not correctly DER encoded

decode-pair 30 04 02 02 80 00
match Foo = { Test-Integer = -32768 }

decode-pair 30 05 02 02 7F FF
match Foo = { Test-Integer = 32767 }

decode-pair 30 05 02 03 00 80 00
match Foo = { Test-Integer = 32768 }

decode-pair 30 05 02 03 FF 80 00
match Integer is not correctly DER encoded

decode-pair 30 05 02 03 00 70 00
match Integer is not correctly DER encoded

decode-pair 30 05 02 03 80 00 00
match Foo = { Test-Integer = -8388608 }

decode-pair 30 05 02 03 7F FF FF
match Foo = { Test-Integer = 8388607 }

decode-pair 30 06 02 04 00 80 00 00
match Foo = { Test-Integer = 8388608 }

decode-pair 30 06 02 04 FF 80 00 00
match Integer is not correctly DER encoded

decode-pair 30 06 02 04 00 70 00 00
match Integer is not correctly DER encoded

decode-pair 30 06 02 04 80 00 00 00
match Foo = { Test-Integer = -2147483648 }

decode-pair 30 06 02 04 7F FF FF FF
match Foo = { Test-Integer = 2147483647 }

decode-pair 30 07 02 05 00 80 00 00 00
match Foo = { Test-Integer = 2147483648 }

decode-pair 30 07 02 05 FF 80 00 00 00
match Integer is not correctly DER encoded

decode-pair 30 07 02 05 00 70 00 00 00
match Integer is not correctly DER encoded

decode-pair 30 07 02 05 80 00 00 00 00
match Foo = { Test-Integer = -549755813888 }

decode-pair 30 07 02 05 7F FF FF FF FF
match Foo = { Test-Integer = 549755813887 }

decode-pair 30 08 02 06 00 80 00 00 00 00
match Foo = { Test-Integer = 549755813888 }

decode-pair 30 08 02 06 FF 80 00 00 00 00
match Integer is not correctly DER encoded

decode-pair 30 08 02 06 00 70 00 00 00 00
match Integer is not correctly DER encoded

decode-pair 30 08 02 06 80 00 00 00 00 00
match Foo = { Test-Integer = -140737488355328 }

decode-pair 30 08 02 06 7F FF FF FF FF FF
match Foo = { Test-Integer = 140737488355327 }

decode-pair 30 09 02 07 00 80 00 00 00 00 00
match Foo = { Test-Integer = 140737488355328 }

decode-pair 30 09 02 07 FF 80 00 00 00 00 00
match Integer is not correctly DER encoded

decode-pair 30 09 02 07 00 70 00 00 00 00 00
match Integer is not correctly DER encoded

decode-pair 30 09 02 07 80 00 00 00 00 00 00
match Foo = { Test-Integer = -36028797018963968 }

decode-pair 30 09 02 07 7F FF FF FF FF FF FF
match Foo = { Test-Integer = 36028797018963967 }

decode-pair 30 0A 02 08 00 80 00 00 00 00 00 00
match Foo = { Test-Integer = 36028797018963968 }

decode-pair 30 0A 02 08 FF 80 00 00 00 00 00 00
match Integer is not correctly DER encoded

decode-pair 30 0A 02 08 00 70 00 00 00 00 00 00
match Integer is not correctly DER encoded

decode-pair 30 0A 02 08 80 00 00 00 00 00 00 00
match Foo = { Test-Integer = -9223372036854775808 }

decode-pair 30 0A 02 08 7F FF FF FF FF FF FF FF
match Foo = { Test-Integer = 9223372036854775807 }

decode-pair 30 0B 02 09 00 80 00 00 00 00 00 00 00
match Integer too large (9)

proto-dictionary-root Bar

decode-pair 30 03 01 01 00
match Bar = { Test-Boolean = no }

decode-pair 30 30 01 01 FF
match Bar = { Test-Boolean = yes }

decode-pair 30 03 01 01 01
match Boolean is not correctly DER encoded


proto-dictionary-root Foo-Bar

decode-pair 30 06 02 01 09 01 01 00
match Foo-Bar = { Test-Integer = 9, Test-Boolean = no }

decode-pair 30 06 02 01 09 01 01 FF
match Foo-Bar = { Test-Integer = 9, Test-Boolean = yes }

decode-pair 30 06 02 01 09 01 01 01
match Boolean is not correctly DER encoded


proto-dictionary-root SEQ-BITSTRING-OCTETS

decode-pair 30 04 03 02 00 01
match Seq-Bitstring-Octets = { Test-Bitstring = 0x0001 }

decode-pair 30 03 03 01 00
match Seq-Bitstring-Octets = { Test-Bitstring = 0x00 }

decode-pair 30 04 03 02 01 02
match Seq-Bitstring-Octets = { Test-Bitstring = 0x0102 }

decode-pair 30 04 03 02 01 03
match Seq-Bitstring-Octets = { Test-Bitstring = 0x0102 }

decode-pair 30 05 03 03 01 03 03
match Seq-Bitstring-Octets = { Test-Bitstring = 0x010302 }

decode-pair 30 09 03 07 04 0A 3B 5F 29 1C D0
match Seq-Bitstring-Octets = { Test-Bitstring = 0x040a3b5f291cd0 }

decode-pair 30 09 03 07 04 0A 3B 5F 29 1C DF
match Seq-Bitstring-Octets = { Test-Bitstring = 0x040a3b5f291cd0 }

decode-pair 30 04 03 01
match Insufficient data for bitstring

decode-pair 30 04 03 01 08
match Invalid number of unused bits

decode-pair 30 04 03 01 01
match Insufficient data for bitstring


proto-dictionary-root Bitstring-Struct

decode-pair 03 02 00 01
match Bitstring-Struct = { foo = 1 }

decode-pair 03 02 01 00
match Bitstring-Struct = { foo = 0 }

decode-pair 03 03 00 FB FB
match Bitstring-Struct = { foo = 251, bar = 15, foo-bar = 11 }

decode-pair 03 04 00 FF FF FF
match Bitstring-Struct = { foo = 255, bar = 15, foo-bar = 15 }


proto-dictionary-root Bitstring-Struct-7

decode-pair 03 02 01 FB
match Bitstring-Struct-7 = { foo = 3, bar = yes, foo-bar = 13 }
